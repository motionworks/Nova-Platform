(function($){var _ajax=$.ajax,mockHandlers=[];function parseXML(xml){if(window['DOMParser']==undefined&&window.ActiveXObject){DOMParser=function(){};DOMParser.prototype.parseFromString=function(xmlString){var doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(xmlString);return doc}}try{var xmlDoc=(new DOMParser()).parseFromString(xml,'text/xml');if($.isXMLDoc(xmlDoc)){var err=$('parsererror',xmlDoc);if(err.length==1){throw('Error: '+$(xmlDoc).text())}}else{throw('Unable to parse XML')}}catch(e){var msg=(e.name==undefined?e:e.name+': '+e.message);$(document).trigger('xmlParseError',[msg]);return undefined}return xmlDoc}$.extend({ajax:function(origSettings){var s=jQuery.extend(true,{},jQuery.ajaxSettings,origSettings),mock=false;$.each(mockHandlers,function(k,v){if(!mockHandlers[k]){return}var m=null;if($.isFunction(mockHandlers[k])){m=mockHandlers[k](s)}else{m=mockHandlers[k];if($.isFunction(m.url.test)){if(!m.url.test(s.url)){m=null}}else{var star=m.url.indexOf('*');if((m.url!='*'&&m.url!=s.url&&star==-1)||(star>-1&&m.url.substr(0,star)!=s.url.substr(0,star))){m=null}}if(m){if(m.data&&s.data){var identical=false;(function ident(mock,live){if(typeof live==='string'){identical=$.isFunction(mock.test)?mock.test(live):mock==live;return identical}$.each(mock,function(k,v){if(live[k]===undefined){identical=false;return false}else{identical=true;if(typeof live[k]=='object'){return ident(mock[k],live[k])}else{if($.isFunction(mock[k].test)){identical=mock[k].test(live[k])}else{identical=(mock[k]==live[k])}return identical}}})})(m.data,s.data);if(identical==false){m=null}}if(m&&m.type&&m.type!=s.type){m=null}}}if(m){mock=true;var c=$.extend({},$.mockjaxSettings,m);if(c.log&&$.isFunction(c.log)){c.log('MOCK '+s.type.toUpperCase()+': '+s.url,$.extend({},s))}var jsre=/=\?(&|$)/,jsc=(new Date()).getTime();if(s.dataType==="jsonp"){if(s.type.toUpperCase()==="GET"){if(!jsre.test(s.url)){s.url+=(rquery.test(s.url)?"&":"?")+(s.jsonp||"callback")+"=?"}}else if(!s.data||!jsre.test(s.data)){s.data=(s.data?s.data+"&":"")+(s.jsonp||"callback")+"=?"}s.dataType="json"}if(s.dataType==="json"&&(s.data&&jsre.test(s.data)||jsre.test(s.url))){jsonp=s.jsonpCallback||("jsonp"+jsc++);if(s.data){s.data=(s.data+"").replace(jsre,"="+jsonp+"$1")}s.url=s.url.replace(jsre,"="+jsonp+"$1");s.dataType="script";window[jsonp]=window[jsonp]||function(tmp){data=tmp;success();complete();window[jsonp]=undefined;try{delete window[jsonp]}catch(e){}if(head){head.removeChild(script)}}}var rurl=/^(\w+:)?\/\/([^\/?#]+)/,parts=rurl.exec(s.url),remote=parts&&(parts[1]&&parts[1]!==location.protocol||parts[2]!==location.host);if(s.dataType==="script"&&s.type.toUpperCase()==="GET"&&remote){var callbackContext=origSettings&&origSettings.context||s;function success(){if(s.success){s.success.call(callbackContext,(m.response?m.response.toString():m.responseText||''),status,{})}if(s.global){trigger("ajaxSuccess",[{},s])}}function complete(){if(s.complete){s.complete.call(callbackContext,{},status)}if(s.global){trigger("ajaxComplete",[{},s])}if(s.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}}function trigger(type,args){(s.context?jQuery(s.context):jQuery.event).trigger(type,args)}if(m.response&&$.isFunction(m.response)){m.response(origSettings)}else{$.globalEval(m.responseText)}success();complete();return false}mock=_ajax.call($,$.extend(true,{},origSettings,{xhr:function(){m=$.extend({},$.mockjaxSettings,m);if(m.contentType){m.headers['content-type']=m.contentType}return{status:m.status,readyState:1,open:function(){},send:function(){var process=(function(that){return function(){return(function(){this.status=m.status;this.readyState=4;if($.isFunction(m.response)){m.response(origSettings)}if(s.dataType=='json'&&(typeof m.responseText=='object')){this.responseText=JSON.stringify(m.responseText)}else if(s.dataType=='xml'){if(typeof m.responseXML=='string'){this.responseXML=parseXML(m.responseXML)}else{this.responseXML=m.responseXML}}else{this.responseText=m.responseText}if($.isFunction(this.onreadystatechange)){this.onreadystatechange(m.isTimeout?'timeout':undefined)}}).apply(that)}})(this);if(m.proxy){_ajax({global:false,url:m.proxy,type:m.proxyType,data:m.data,dataType:s.dataType,complete:function(xhr,txt){m.responseXML=xhr.responseXML;m.responseText=xhr.responseText;this.responseTimer=setTimeout(process,m.responseTime||0)}})}else{if(s.async===false){process()}else{this.responseTimer=setTimeout(process,m.responseTime||50)}}},abort:function(){clearTimeout(this.responseTimer)},setRequestHeader:function(){},getResponseHeader:function(header){if(m.headers&&m.headers[header]){return m.headers[header]}else if(header.toLowerCase()=='last-modified'){return m.lastModified||(new Date()).toString()}else if(header.toLowerCase()=='etag'){return m.etag||''}else if(header.toLowerCase()=='content-type'){return m.contentType||'text/plain'}},getAllResponseHeaders:function(){var headers='';$.each(m.headers,function(k,v){headers+=k+': '+v+"\n"});return headers}}}}));return false}});if(!mock){return _ajax.apply($,arguments)}else{return mock}}});$.mockjaxSettings={log:function(msg){window['console']&&window.console.log&&window.console.log(msg)},status:200,responseTime:500,isTimeout:false,contentType:'text/plain',response:'',responseText:'',responseXML:'',proxy:'',proxyType:'GET',lastModified:null,etag:'',headers:{etag:'IJF@H#@923uf8023hFO@I#H#','content-type':'text/plain'}};$.mockjax=function(settings){var i=mockHandlers.length;mockHandlers[i]=settings;return i};$.mockjaxClear=function(i){if(arguments.length==1){mockHandlers[i]=null}else{mockHandlers=[]}}})(jQuery);